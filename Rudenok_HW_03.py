import pandas as pd

"""
Завдання 1
У вас є дані про книги з полями: "Назва", "Автор", "Рік видання", "Ціна".
Створіть DataFrame з не менш ніж шістьма рядками.
Виведіть увесь DataFrame.
Визначте середню ціну книг.
Знайдіть книги, видані після 2015 року.
Відсортуйте DataFrame за ціною в порядку зростання.
"""

print("Завдання № 1")

data = {
    "Назва": [
        "Червоне і чорне", "Собака на сіні", "Азійська сага",
        "Гамлет, принц данський", "Велика четвірка", "Граф Монте-Крісто"
    ],
    "Автор": [
        "Стендаль", "Лопе де Вега", "Джеймс Клавелл",
        "Вільям Шекспір", "Аґата Крісті", "Александр Дюма"
    ],
    "Рік видання": [2025, 2014, 2012, 2007, 2024, 2023],
    "Ціна": [405, 299, 520, 280, 300, 262]
}

df = pd.DataFrame(data)

print("Всі книги:")
print(df)

average_price = df["Ціна"].mean()
print(f"Середня ціна книг: {average_price:.2f} грн")

recent_books = df[df["Рік видання"] > 2015]
print("Книги, видані після 2015 року:")
print(recent_books)

sorted_df = df.sort_values(by="Ціна")
print("Книги, відсортовані за ціною в порядку зростання:")
print(sorted_df)

"""
Завдання 2
У DataFrame містяться дані про замовлення: "Номер замовлення", "Клієнт", "Дата", "Сума".
Прочитайте дані з DataFrame.
Виведіть перші десять рядків.
Визначте кількість замовлень кожного клієнта.
Знайдіть максимальну та мінімальну суми замовлень.
Підрахуйте загальну суму всіх замовлень.
"""

print("Завдання № 2")
import pandas as pd

data = {
    'Номер замовлення': range(1, 16),
    'Клієнт': ['Тарас', 'Антон', 'Людмила', 'Ірина', 'Роман', 'Тарас', 'Олена', 'Степан', 'Людмила', 'Олена', 'Роман', 'Тарас', 'Ірина', 'Олена', 'Ірина'],
    'Дата': ['01.08.2025', '11.08.2025', '15.08.2025', '22.08.2025', '24.08.2025', '26.08.2025', '27.08.2025', '29.08.2025', '01.09.2025', '02.09.2025', '03.09.2025', '05.09.2025', '06.09.2025', '08.09.2025', '09.09.2025'],
    'Сума': [1200, 800, 950, 1100, 700, 1050, 1300, 900, 980, 1250, 850, 1020, 1400, 870, 990]
}

df = pd.DataFrame(data)

print("Всі замовлення:")
print(df)

print("Перші 10 рядків:")
print(df.head(10))

print("Кількість замовлень по клієнтах:")
print(df['Клієнт'].value_counts())

print("Максимальна сума замовлення:", df['Сума'].max())
print("Мінімальна сума замовлення:", df['Сума'].min())

print("Загальна сума всіх замовлень:", df['Сума'].sum())




"""
Завдання 3
Є таблиця з даними про продукти харчування: "Продукт", "Категорія", "Калорії", "Білки".
Створіть DataFrame з не менш ніж десятьма рядками.
Виведіть увесь DataFrame.
Знайдіть усі продукти з калорійністю вище 300.
Підрахуйте середню кількість білків за категоріями.
Відсортуйте DataFrame за калорійністю в порядку убування.
"""

print("Завдання № 3")

data = {
    "Продукт": [
        "Скумбрія", "Сир твердий", "Авокадо", "Гречка", "Шоколад",
        "Йогурт", "Манка", "Лосось", "Банан", "Цукерки"
    ],
    "Категорія": [
        "Риба", "Молочні", "Фрукти", "Крупа", "Солодощі",
        "Молочні", "Крупа", "Риба", "Фрукти", "Солодощі"
    ],
    "Калорії": [214, 350, 160, 313, 546, 95, 352, 208, 105, 512],
    "Білки": [21, 25, 2, 12, 7, 9, 10, 20, 1, 5]
}

df = pd.DataFrame(data)

print("Всі продукти:")
print(df)

high_calories = df[df["Калорії"] > 300]
print("Продукти з калорійністю понад 300:")
print(high_calories)

avg_protein = df.groupby("Категорія")["Білки"].mean()
print("Середня кількість білків за категоріями:")
print(avg_protein)

sorted_df = df.sort_values(by="Калорії", ascending=False)
print("Продукти, відсортовані за калорійністю в порядку убування:")
print(sorted_df)

"""
Завдання 4
Зібрано дані про співробітників та їхні проекти: "Ім'я", "Проект", "Години".
Створіть DataFrame з не менш ніж вісьмома рядками.
Виведіть вихідний DataFrame.
Підрахуйте загальну кількість годин за кожним співробітником.
Підрахуйте загальну кількість годин за кожним проектом.
Знайдіть співробітника, який витратив найбільше годин.
"""

print("Завдання № 4")

data = {
    "Ім'я": [
        "Тарас", "Антон", "Людмила", "Антон", "Тарас",
        "Людмила", "Єгор", "Тарас"
    ],
    "Проект": [
        "Інтернет магазин - Django", "Міні-гра Змійка - С++",
        "Менеджер контактів - С#", "Інтернет магазин - Django",
        "Менеджер контактів - С#",
        "Персональний менеджер завдань - C#", "Інтернет магазин - Django",
        "Міні-гра Змійка - С++"
    ],
    "Години": [45, 20, 22, 25, 35, 24, 15, 30]
}

df = pd.DataFrame(data)

print("Вихідний DataFrame:")
print(df)

total_hours_by_employee = df.groupby("Ім'я")["Години"].sum()
print("Загальна кількість годин за співробітниками:")
print(total_hours_by_employee)

total_hours_by_project = df.groupby("Проект")["Години"].sum()
print("Загальна кількість годин за проектами:")
print(total_hours_by_project)

top_employee = total_hours_by_employee.idxmax()
max_hours = total_hours_by_employee.max()
print(f"Найбільше годин витратив(ла): {top_employee} — {max_hours} годин")

"""
Завдання 5
У вас є таблиця продажів квитків: "Фільм", "Місто", "Продані квитки".
Створіть DataFrame з не менш ніж дванадцятьма рядками.
Виведіть увесь DataFrame.
Підрахуйте загальну кількість проданих квитків за кожним фільмом.
Підрахуйте загальну кількість квитків по кожному місту.
Знайдіть фільм із найбільшою кількістю продажів.
"""

print("Завдання № 5")

data = {
    "Фільм": [
        "Список Шиндлера", "Аватар", "Матриця", "Список Шиндлера",
        "З міркувань совісті", "Атлантида", "Аватар", "Список Шиндлера",
        "Володар перснів", "Матриця", "Аватар", "З міркувань совісті"
    ],
    "Місто": [
        "Київ", "Вінниця", "Львів", "Житомир", "Запоріжжя", "Київ",
        "Львів", "Київ", "Вінниця", "Полтава", "Житомир", "Полтава"
    ],
    "Продані квитки": [
        1200, 950, 800, 600, 1100, 1300,
        700, 900, 650, 1250, 708, 850
    ]
}

df = pd.DataFrame(data)

print("Всі фільми:")
print(df)

total_by_film = df.groupby("Фільм")["Продані квитки"].sum()
print("Загальна кількість проданих квитків за кожним фільмом:")
print(total_by_film)

total_by_city = df.groupby("Місто")["Продані квитки"].sum()
print("Загальна кількість квитків по кожному місту:")
print(total_by_city)

top_film = total_by_film.idxmax()
top_sales = total_by_film.max()
print(f"Фільм із найбільшою кількістю продажів: {top_film} — {top_sales} квитків")

"""
Завдання 6
Дано дві таблиці: перша з інформацією про клієнтів ("ID", "Ім'я", "Місто"), друга — з їхніми замовленнями ("ID клієнта", "Замовлення", "Вартість").
Створіть два DataFrame і заповніть їх не менш ніж п'ятьма рядками кожен.
Виведіть обидва DataFrame.
Об'єднайте їх за ідентифікатором клієнта.
Підрахуйте загальну вартість замовлень за кожним клієнтом.
Виведіть результат у вигляді нового DataFrame.
"""

print("Завдання № 6")

clients_data = {
    "ID": [1, 2, 3, 4, 5],
    "Ім'я": ["Тарас", "Антон", "Ірина", "Людмила", "Олена"],
    "Місто": ["Київ", "Вінниця", "Дніпро", "Житомир", "Запоріжжя"]
}
clients_df = pd.DataFrame(clients_data)

orders_data = {
    "ID клієнта": [1, 2, 1, 3, 4, 2, 5],
    "Замовлення": ["Ноутбук", "Телефон", "Мишка", "Монітор", "Клавіатура", "Навушники", "Планшет"],
    "Вартість": [15000, 8000, 580, 7000, 600, 1200, 12000]
}
orders_df = pd.DataFrame(orders_data)

print("Інформація про клієнтів:")
print(clients_df)

print("Замовлення клієнтів:")
print(orders_df)

merged_df = pd.merge(clients_df, orders_df, left_on="ID", right_on="ID клієнта")

print("Об'єднана таблиця:")
print(merged_df)

total_orders = merged_df.groupby(["ID", "Ім'я", "Місто"])["Вартість"].sum().reset_index()
total_orders.rename(columns={"Вартість": "Загальна вартість"}, inplace=True)

print("Загальна вартість замовлень за кожним клієнтом:")
print(total_orders)

